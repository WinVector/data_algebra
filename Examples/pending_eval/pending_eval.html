<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">def</span> recursive_example(n, d<span class="op">=</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">    <span class="cf">if</span> n <span class="op">&lt;=</span> <span class="dv">1</span>:</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">        <span class="cf">return</span> d</a>
<a class="sourceLine" id="cb1-4" data-line-number="4">    <span class="cf">else</span>:</a>
<a class="sourceLine" id="cb1-5" data-line-number="5">        <span class="cf">return</span> recursive_example(n <span class="op">-</span> <span class="dv">1</span>, d <span class="op">+</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1-6" data-line-number="6"></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="cf">try</span>:</a>
<a class="sourceLine" id="cb1-8" data-line-number="8">    recursive_example(<span class="dv">10000</span>)</a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="cf">except</span> <span class="pp">Exception</span> <span class="im">as</span> ex:</a>
<a class="sourceLine" id="cb1-10" data-line-number="10">    <span class="bu">print</span>(ex)</a></code></pre></div>
<pre><code>maximum recursion depth exceeded in comparison</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="im">import</span> data_algebra.pending_eval</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="kw">def</span> recursive_example_ex(n, d<span class="op">=</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">    <span class="cf">if</span> n <span class="op">&lt;=</span> <span class="dv">1</span>:</a>
<a class="sourceLine" id="cb3-5" data-line-number="5">        <span class="cf">return</span> d</a>
<a class="sourceLine" id="cb3-6" data-line-number="6">    <span class="cf">else</span>:</a>
<a class="sourceLine" id="cb3-7" data-line-number="7">        <span class="co"># eliminate tail-call by using exception</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8">        <span class="co"># instead of return recursive_example_ex(n-1, d+1)</span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9">        <span class="cf">raise</span> data_algebra.pending_eval.PendingFunctionEvaluation(recursive_example_ex, n <span class="op">-</span> <span class="dv">1</span>, d <span class="op">+</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb3-10" data-line-number="10"></a>
<a class="sourceLine" id="cb3-11" data-line-number="11">data_algebra.pending_eval.eval_using_exceptions(recursive_example_ex, <span class="dv">100000</span>)</a></code></pre></div>
<pre><code>100000</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw">class</span> C:</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"></a>
<a class="sourceLine" id="cb5-3" data-line-number="3">    <span class="kw">def</span> f_(<span class="va">self</span>, n, d<span class="op">=</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb5-4" data-line-number="4">        <span class="cf">if</span> n <span class="op">&lt;=</span> <span class="dv">1</span>:</a>
<a class="sourceLine" id="cb5-5" data-line-number="5">            <span class="cf">return</span> d</a>
<a class="sourceLine" id="cb5-6" data-line-number="6">        <span class="cf">else</span>:</a>
<a class="sourceLine" id="cb5-7" data-line-number="7">            <span class="co"># Eliminate tail-call by using an exception.</span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8">            <span class="co"># instead of: return self.f_(n-1, d+1), use:</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9">            <span class="cf">raise</span> data_algebra.pending_eval.PendingFunctionEvaluation(<span class="va">self</span>.f_, n <span class="op">-</span> <span class="dv">1</span>, d <span class="op">+</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb5-10" data-line-number="10"></a>
<a class="sourceLine" id="cb5-11" data-line-number="11">    <span class="kw">def</span> f(<span class="va">self</span>, n, d<span class="op">=</span><span class="dv">1</span>):</a>
<a class="sourceLine" id="cb5-12" data-line-number="12">        <span class="cf">return</span> data_algebra.pending_eval.eval_using_exceptions(<span class="va">self</span>.f_, n<span class="op">=</span>n, d<span class="op">=</span>d)</a>
<a class="sourceLine" id="cb5-13" data-line-number="13"></a>
<a class="sourceLine" id="cb5-14" data-line-number="14">o <span class="op">=</span> C()</a>
<a class="sourceLine" id="cb5-15" data-line-number="15">o.f(<span class="dv">100000</span>)</a>
<a class="sourceLine" id="cb5-16" data-line-number="16"></a></code></pre></div>
<pre><code>100000</code></pre>
